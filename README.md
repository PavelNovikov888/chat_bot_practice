# Практическое задание: "Создание чат-бота"

**Описание:** Создать чат-бот, который по продуктовому запросу рекомендует товары, по остальным запросам отвечает "болталкой". 

**Данные:** Продуктовые запросы находятся в файле  [ProductsDataset.zip](https://drive.google.com/file/d/17OdOPIH9d-T6d1Rb6F0IQuI7P9xoGWHi/view?usp=drive_link)    
Основой для вопросов и ответов являются данные об ответах и вопросах с соответствующего раздела сайта mail.ru [Otvety.txt](https://disk.yandex.ru/d/ikeJ8Tu2LxPkeA) 

**ВНИМАНИЕ!:** ЗАКОММЕЧЕННЫЕ СТРОКИ КОДА СОДЕРЖАТ ДОЛГОВЫПОЛНЯЮЩИЙСЯ КОД. ДЛЯ ЭКОНОМИИ ВРЕМЕНИ РЕЗУЛЬТАТЫ ВЫПОЛНЕНИЯ КОДА В ДАННЫХ ЯЧЕЙКАХ ЗАГРУЖАЮТСЯ В НАЧАЛЕ РАБОТЫ НОУТБУКА. 

**Задачи:**
*   Совершить предобработку текстов в данных об вопросах-ответах и продуктах:
  *   Обучить **word2vec**
  *   Получить эмбеддинги
  *   Удалить знаки препинания
  *   Сделать лемматизацию
* Сложить в индекс все вопросы при помощи библиотеки **annoy**
* Векторизовать ответы, вектором считать усреднённую сумму **word2vec** слов, которые входят в ответ  
* Реализовать метод, который получит на вход вопрос и найдёт ответ к нему.
* Обучить классификатор: продуктовый запрос vs. всё остальное (продуктовым можно считать запрос, который равен названию или описанию товара).
* Добавить логику поиска похожих товаров по продуктовому запросу. Всю логику завернуть в метод get_answer(). Ответ на продуктовый запрос должен иметь вид "product_id title".

**Результаты:**  
→ 1. Обучен классификатор «товарный запрос vs. болталка»
* Осуществлён препроцессинг текста (как минимум удаление знаков препинания, приведение к нижнему регистру, стемминг/лемматизация).
* Текст векторизирован любым из изученных способов (CountVectorizer, TfidfVectorizer, HashingVectorizer, Word2Vec).
* Выборка разделена на обучающую и валидационную.
* Обучен классификатор с расчётом метрик на валидации (любое семейство алгоритмов, но предпочтительнее просто логистическая регрессия).
* Модель сохранена и при применении загружается из pkl-файла (или аналога).
  
→ 2. Реализован поиск похожих товаров в контентной части бота
* Все названия товаров свёрнуты в векторное представление Word2Vec (предобученном или обученном на исходном датасете).
* Построен индекс по названиям документов.
* Для товарных запросов реализован поиск в индексе (запрос также оборачивается Word2Vec, происходит проход в индекс).
  
→ 3. Реализована болталка
* Все вопросы из датасета свёрнуты Word2Vec в векторное представление.
* Построен индекс по вопросам.
* На запрос в болталку происходит поиск ближайшего вопроса и возвращается ответ на этот вопрос.



